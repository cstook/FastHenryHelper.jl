function testconnectnodes()
  n1 = Node(1,2,3)
  n2 = Node(4,5,6)
  n3 = Node(7,8,9)
  sp = SegmentParameters(w=10,h=2,sigma=3)
  segmentarray = connectnodes([n1,n2,n3],sp)
  @test length(segmentarray) == 2
  g6 = Group([n1,n2,n3,segmentarray...])
  verified =
  """
  N_1 x=1.000000000e+00 y=2.000000000e+00 z=3.000000000e+00
  N_2 x=4.000000000e+00 y=5.000000000e+00 z=6.000000000e+00
  N_3 x=7.000000000e+00 y=8.000000000e+00 z=9.000000000e+00
  E_4 N_1 N_2
  +  w=1.000000000e+01 h=2.000000000e+00
  +  sigma=3.000000000e+00
  E_5 N_2 N_3
  +  w=1.000000000e+01 h=2.000000000e+00
  +  sigma=3.000000000e+00
  """
  testelement(g6,verified)
end
testconnectnodes()

function testviagroup()
  @test_throws(ArgumentError,viagroup(height=20, h=3))
  @test_throws(ArgumentError,viagroup(radius=10, h=3))
  @test_throws(ArgumentError,viagroup(radius=10, height=20))
  @test_throws(ArgumentError,viagroup(radius=10, height=20, h=3,n=1))
  via = viagroup(radius=10, height=20, h=3)
  verified =
  """
  N_1 x=1.000000000e+01 y=0.000000000e+00 z=0.000000000e+00
  N_2 x=7.071067812e+00 y=7.071067812e+00 z=0.000000000e+00
  N_3 x=6.123233996e-16 y=1.000000000e+01 z=0.000000000e+00
  N_4 x=-7.071067812e+00 y=7.071067812e+00 z=0.000000000e+00
  N_5 x=-1.000000000e+01 y=1.224646799e-15 z=0.000000000e+00
  N_6 x=-7.071067812e+00 y=-7.071067812e+00 z=0.000000000e+00
  N_7 x=-1.836970199e-15 y=-1.000000000e+01 z=0.000000000e+00
  N_8 x=7.071067812e+00 y=-7.071067812e+00 z=0.000000000e+00
  N_9 x=1.000000000e+01 y=0.000000000e+00 z=-2.000000000e+01
  N_10 x=7.071067812e+00 y=7.071067812e+00 z=-2.000000000e+01
  N_11 x=6.123233996e-16 y=1.000000000e+01 z=-2.000000000e+01
  N_12 x=-7.071067812e+00 y=7.071067812e+00 z=-2.000000000e+01
  N_13 x=-1.000000000e+01 y=1.224646799e-15 z=-2.000000000e+01
  N_14 x=-7.071067812e+00 y=-7.071067812e+00 z=-2.000000000e+01
  N_15 x=-1.836970199e-15 y=-1.000000000e+01 z=-2.000000000e+01
  N_16 x=7.071067812e+00 y=-7.071067812e+00 z=-2.000000000e+01
  N_17 x=0.000000000e+00 y=0.000000000e+00 z=0.000000000e+00
  N_18 x=0.000000000e+00 y=0.000000000e+00 z=-2.000000000e+01
  .equiv N_17 N_1 N_2 N_3 N_4 N_5 N_6 N_7 N_8
  .equiv N_18 N_9 N_10 N_11 N_12 N_13 N_14 N_15 N_16
  E_19 N_1 N_9
  +  w=8.284271247e+00 h=3.000000000e+00 nhinc=5 nwinc=1
  +  wx=6.123233996e-17 wy=1.000000000e+00 wz=0.000000000e+00
  E_20 N_2 N_10
  +  w=8.284271247e+00 h=3.000000000e+00 nhinc=5 nwinc=1
  +  wx=-7.071067812e-01 wy=7.071067812e-01 wz=0.000000000e+00
  E_21 N_3 N_11
  +  w=8.284271247e+00 h=3.000000000e+00 nhinc=5 nwinc=1
  +  wx=-1.000000000e+00 wy=1.224646799e-16 wz=0.000000000e+00
  E_22 N_4 N_12
  +  w=8.284271247e+00 h=3.000000000e+00 nhinc=5 nwinc=1
  +  wx=-7.071067812e-01 wy=-7.071067812e-01 wz=0.000000000e+00
  E_23 N_5 N_13
  +  w=8.284271247e+00 h=3.000000000e+00 nhinc=5 nwinc=1
  +  wx=-1.836970199e-16 wy=-1.000000000e+00 wz=0.000000000e+00
  E_24 N_6 N_14
  +  w=8.284271247e+00 h=3.000000000e+00 nhinc=5 nwinc=1
  +  wx=7.071067812e-01 wy=-7.071067812e-01 wz=0.000000000e+00
  E_25 N_7 N_15
  +  w=8.284271247e+00 h=3.000000000e+00 nhinc=5 nwinc=1
  +  wx=1.000000000e+00 wy=-2.449293598e-16 wz=0.000000000e+00
  E_26 N_8 N_16
  +  w=8.284271247e+00 h=3.000000000e+00 nhinc=5 nwinc=1
  +  wx=7.071067812e-01 wy=7.071067812e-01 wz=0.000000000e+00
  """
  testelement(via, verified)
  @test length(via[:alltop]) == 8
  @test length(via[:allbot]) == 8
  @test typeof(via[:top]) == Node
  @test typeof(via[:top]) == Node
  xyz(via[:top]) == [0.0,0.0,0.0]
end
testviagroup()

function testhelixnodes()
  radius = 10.0
  pitch = 2.0
  radians = 4π
  radiansperpoint = π/4
  hp1 = helixnodes(radius, pitch, radians, radiansperpoint)
  verified =
  """
  N_1 x=1.000000000e+01 y=0.000000000e+00 z=0.000000000e+00
  N_2 x=7.071067812e+00 y=7.071067812e+00 z=2.500000000e-01
  N_3 x=6.123233996e-16 y=1.000000000e+01 z=5.000000000e-01
  N_4 x=-7.071067812e+00 y=7.071067812e+00 z=7.500000000e-01
  N_5 x=-1.000000000e+01 y=1.224646799e-15 z=1.000000000e+00
  N_6 x=-7.071067812e+00 y=-7.071067812e+00 z=1.250000000e+00
  N_7 x=-1.836970199e-15 y=-1.000000000e+01 z=1.500000000e+00
  N_8 x=7.071067812e+00 y=-7.071067812e+00 z=1.750000000e+00
  N_9 x=1.000000000e+01 y=-2.449293598e-15 z=2.000000000e+00
  N_10 x=7.071067812e+00 y=7.071067812e+00 z=2.250000000e+00
  N_11 x=3.061616998e-15 y=1.000000000e+01 z=2.500000000e+00
  N_12 x=-7.071067812e+00 y=7.071067812e+00 z=2.750000000e+00
  N_13 x=-1.000000000e+01 y=3.673940397e-15 z=3.000000000e+00
  N_14 x=-7.071067812e+00 y=-7.071067812e+00 z=3.250000000e+00
  N_15 x=-4.286263797e-15 y=-1.000000000e+01 z=3.500000000e+00
  N_16 x=7.071067812e+00 y=-7.071067812e+00 z=3.750000000e+00
  N_17 x=1.000000000e+01 y=-4.898587197e-15 z=4.000000000e+00
  """
  testelement(Group(hp1), verified)
  hp2 = helixnodes(radius, pitch, radians+0.1, radiansperpoint)
  verified =
  """
  N_1 x=1.000000000e+01 y=0.000000000e+00 z=0.000000000e+00
  N_2 x=7.071067812e+00 y=7.071067812e+00 z=2.500000000e-01
  N_3 x=6.123233996e-16 y=1.000000000e+01 z=5.000000000e-01
  N_4 x=-7.071067812e+00 y=7.071067812e+00 z=7.500000000e-01
  N_5 x=-1.000000000e+01 y=1.224646799e-15 z=1.000000000e+00
  N_6 x=-7.071067812e+00 y=-7.071067812e+00 z=1.250000000e+00
  N_7 x=-1.836970199e-15 y=-1.000000000e+01 z=1.500000000e+00
  N_8 x=7.071067812e+00 y=-7.071067812e+00 z=1.750000000e+00
  N_9 x=1.000000000e+01 y=-2.449293598e-15 z=2.000000000e+00
  N_10 x=7.071067812e+00 y=7.071067812e+00 z=2.250000000e+00
  N_11 x=3.061616998e-15 y=1.000000000e+01 z=2.500000000e+00
  N_12 x=-7.071067812e+00 y=7.071067812e+00 z=2.750000000e+00
  N_13 x=-1.000000000e+01 y=3.673940397e-15 z=3.000000000e+00
  N_14 x=-7.071067812e+00 y=-7.071067812e+00 z=3.250000000e+00
  N_15 x=-4.286263797e-15 y=-1.000000000e+01 z=3.500000000e+00
  N_16 x=7.071067812e+00 y=-7.071067812e+00 z=3.750000000e+00
  N_17 x=1.000000000e+01 y=-4.898587197e-15 z=4.000000000e+00
  N_18 x=9.950041653e+00 y=9.983341665e-01 z=4.031830989e+00
  """
  testelement(Group(hp2), verified)
end
testhelixnodes()

function testcoilcraft1010vsgroup()
  inductor = coilcraft1010vsgroup("1010VS-111ME")
  @test length(elements(inductor)) == 85
  @test length(keys(terms(inductor))) == 2
  verified =
  """
  .units mm
  N_1 x=3.550000000e+00 y=3.550000000e+00 z=3.250000000e-01
  N_2 x=3.550000000e+00 y=-3.550000000e+00 z=3.250000000e-01
  N_3 x=3.550000000e+00 y=-3.550000000e+00 z=2.025000000e+00
  N_4 x=3.550000000e+00 y=0.000000000e+00 z=2.025000000e+00
  N_5 x=2.510229073e+00 y=2.510229073e+00 z=2.106250000e+00
  N_6 x=2.173748068e-16 y=3.550000000e+00 z=2.187500000e+00
  N_7 x=-2.510229073e+00 y=2.510229073e+00 z=2.268750000e+00
  N_8 x=-3.550000000e+00 y=4.347496137e-16 z=2.350000000e+00
  N_9 x=-2.510229073e+00 y=-2.510229073e+00 z=2.431250000e+00
  N_10 x=-6.521244205e-16 y=-3.550000000e+00 z=2.512500000e+00
  N_11 x=2.510229073e+00 y=-2.510229073e+00 z=2.593750000e+00
  N_12 x=3.550000000e+00 y=-8.694992274e-16 z=2.675000000e+00
  N_13 x=2.510229073e+00 y=2.510229073e+00 z=2.756250000e+00
  N_14 x=1.086874034e-15 y=3.550000000e+00 z=2.837500000e+00
  N_15 x=-2.510229073e+00 y=2.510229073e+00 z=2.918750000e+00
  N_16 x=-3.550000000e+00 y=1.304248841e-15 z=3.000000000e+00
  N_17 x=-2.510229073e+00 y=-2.510229073e+00 z=3.081250000e+00
  N_18 x=-1.521623648e-15 y=-3.550000000e+00 z=3.162500000e+00
  N_19 x=2.510229073e+00 y=-2.510229073e+00 z=3.243750000e+00
  N_20 x=3.550000000e+00 y=-1.738998455e-15 z=3.325000000e+00
  N_21 x=2.510229073e+00 y=2.510229073e+00 z=3.406250000e+00
  N_22 x=1.956373262e-15 y=3.550000000e+00 z=3.487500000e+00
  N_23 x=-2.510229073e+00 y=2.510229073e+00 z=3.568750000e+00
  N_24 x=-3.550000000e+00 y=2.173748068e-15 z=3.650000000e+00
  N_25 x=-2.510229073e+00 y=-2.510229073e+00 z=3.731250000e+00
  N_26 x=-8.697189655e-15 y=-3.550000000e+00 z=3.812500000e+00
  N_27 x=2.510229073e+00 y=-2.510229073e+00 z=3.893750000e+00
  N_28 x=3.550000000e+00 y=-2.608497682e-15 z=3.975000000e+00
  N_29 x=2.510229073e+00 y=2.510229073e+00 z=4.056250000e+00
  N_30 x=-3.480194291e-15 y=3.550000000e+00 z=4.137500000e+00
  N_31 x=-2.510229073e+00 y=2.510229073e+00 z=4.218750000e+00
  N_32 x=-3.550000000e+00 y=3.043247296e-15 z=4.300000000e+00
  N_33 x=-2.510229073e+00 y=-2.510229073e+00 z=4.381250000e+00
  N_34 x=-9.566688883e-15 y=-3.550000000e+00 z=4.462500000e+00
  N_35 x=2.510229073e+00 y=-2.510229073e+00 z=4.543750000e+00
  N_36 x=3.550000000e+00 y=-3.477996910e-15 z=4.625000000e+00
  N_37 x=2.510229073e+00 y=2.510229073e+00 z=4.706250000e+00
  N_38 x=-2.610695063e-15 y=3.550000000e+00 z=4.787500000e+00
  N_39 x=-2.510229073e+00 y=2.510229073e+00 z=4.868750000e+00
  N_40 x=-3.550000000e+00 y=3.912746523e-15 z=4.950000000e+00
  N_41 x=-3.550000000e+00 y=-3.550000000e+00 z=4.950000000e+00
  N_42 x=-3.550000000e+00 y=-3.550000000e+00 z=3.250000000e-01
  N_43 x=-3.550000000e+00 y=3.550000000e+00 z=3.250000000e-01
  E_44 N_1 N_2
  +  w=1.700000000e+00 h=6.000000000e-01
  +  sigma=5.850000000e+04
  E_45 N_2 N_3
  +  w=1.700000000e+00 h=6.000000000e-01
  +  sigma=5.850000000e+04
  E_46 N_3 N_4
  +  w=1.700000000e+00 h=6.000000000e-01
  +  sigma=5.850000000e+04
  E_47 N_4 N_5
  +  w=1.700000000e+00 h=6.000000000e-01
  +  sigma=5.850000000e+04
  E_48 N_5 N_6
  +  w=1.700000000e+00 h=6.000000000e-01
  +  sigma=5.850000000e+04
  E_49 N_6 N_7
  +  w=1.700000000e+00 h=6.000000000e-01
  +  sigma=5.850000000e+04
  E_50 N_7 N_8
  +  w=1.700000000e+00 h=6.000000000e-01
  +  sigma=5.850000000e+04
  E_51 N_8 N_9
  +  w=1.700000000e+00 h=6.000000000e-01
  +  sigma=5.850000000e+04
  E_52 N_9 N_10
  +  w=1.700000000e+00 h=6.000000000e-01
  +  sigma=5.850000000e+04
  E_53 N_10 N_11
  +  w=1.700000000e+00 h=6.000000000e-01
  +  sigma=5.850000000e+04
  E_54 N_11 N_12
  +  w=1.700000000e+00 h=6.000000000e-01
  +  sigma=5.850000000e+04
  E_55 N_12 N_13
  +  w=1.700000000e+00 h=6.000000000e-01
  +  sigma=5.850000000e+04
  E_56 N_13 N_14
  +  w=1.700000000e+00 h=6.000000000e-01
  +  sigma=5.850000000e+04
  E_57 N_14 N_15
  +  w=1.700000000e+00 h=6.000000000e-01
  +  sigma=5.850000000e+04
  E_58 N_15 N_16
  +  w=1.700000000e+00 h=6.000000000e-01
  +  sigma=5.850000000e+04
  E_59 N_16 N_17
  +  w=1.700000000e+00 h=6.000000000e-01
  +  sigma=5.850000000e+04
  E_60 N_17 N_18
  +  w=1.700000000e+00 h=6.000000000e-01
  +  sigma=5.850000000e+04
  E_61 N_18 N_19
  +  w=1.700000000e+00 h=6.000000000e-01
  +  sigma=5.850000000e+04
  E_62 N_19 N_20
  +  w=1.700000000e+00 h=6.000000000e-01
  +  sigma=5.850000000e+04
  E_63 N_20 N_21
  +  w=1.700000000e+00 h=6.000000000e-01
  +  sigma=5.850000000e+04
  E_64 N_21 N_22
  +  w=1.700000000e+00 h=6.000000000e-01
  +  sigma=5.850000000e+04
  E_65 N_22 N_23
  +  w=1.700000000e+00 h=6.000000000e-01
  +  sigma=5.850000000e+04
  E_66 N_23 N_24
  +  w=1.700000000e+00 h=6.000000000e-01
  +  sigma=5.850000000e+04
  E_67 N_24 N_25
  +  w=1.700000000e+00 h=6.000000000e-01
  +  sigma=5.850000000e+04
  E_68 N_25 N_26
  +  w=1.700000000e+00 h=6.000000000e-01
  +  sigma=5.850000000e+04
  E_69 N_26 N_27
  +  w=1.700000000e+00 h=6.000000000e-01
  +  sigma=5.850000000e+04
  E_70 N_27 N_28
  +  w=1.700000000e+00 h=6.000000000e-01
  +  sigma=5.850000000e+04
  E_71 N_28 N_29
  +  w=1.700000000e+00 h=6.000000000e-01
  +  sigma=5.850000000e+04
  E_72 N_29 N_30
  +  w=1.700000000e+00 h=6.000000000e-01
  +  sigma=5.850000000e+04
  E_73 N_30 N_31
  +  w=1.700000000e+00 h=6.000000000e-01
  +  sigma=5.850000000e+04
  E_74 N_31 N_32
  +  w=1.700000000e+00 h=6.000000000e-01
  +  sigma=5.850000000e+04
  E_75 N_32 N_33
  +  w=1.700000000e+00 h=6.000000000e-01
  +  sigma=5.850000000e+04
  E_76 N_33 N_34
  +  w=1.700000000e+00 h=6.000000000e-01
  +  sigma=5.850000000e+04
  E_77 N_34 N_35
  +  w=1.700000000e+00 h=6.000000000e-01
  +  sigma=5.850000000e+04
  E_78 N_35 N_36
  +  w=1.700000000e+00 h=6.000000000e-01
  +  sigma=5.850000000e+04
  E_79 N_36 N_37
  +  w=1.700000000e+00 h=6.000000000e-01
  +  sigma=5.850000000e+04
  E_80 N_37 N_38
  +  w=1.700000000e+00 h=6.000000000e-01
  +  sigma=5.850000000e+04
  E_81 N_38 N_39
  +  w=1.700000000e+00 h=6.000000000e-01
  +  sigma=5.850000000e+04
  E_82 N_39 N_40
  +  w=1.700000000e+00 h=6.000000000e-01
  +  sigma=5.850000000e+04
  E_83 N_40 N_41
  +  w=1.700000000e+00 h=6.000000000e-01
  +  sigma=5.850000000e+04
  E_84 N_41 N_42
  +  w=1.700000000e+00 h=6.000000000e-01
  +  sigma=5.850000000e+04
  E_85 N_42 N_43
  +  w=1.700000000e+00 h=6.000000000e-01
  +  sigma=5.850000000e+04
  """
  testelement(inductor, verified)
end
testcoilcraft1010vsgroup()
