function transformtest1()
  # a line of segments and a plane with nodes, holes
  # using all the units
  g1 = Group([
    n1 = Node(1,0,0),
    Units("m"),
    n2 = Node(2,0,0),
    Units("km"),
    n3 = Node(0.003,0,0),
    Units("cm"),
    n4 = Node(400,0,0),
    Default(w=75, h=25),
    Units("mm"),
    n5 = Node(5000,0,0),
    UniformPlane(x1=1000, y1=1000, z1=-1000,
                 x2=1000, y2=9000, z2=-1000,
                 x3=9000, y3=9000, z3=-1000,
                 thick = 200,
                 seg1 = 20,
                 seg2 = 20,
                 nodes = [Node(2000,2000,-1000),
                          Node(3000,3000,-1000)],
                 holes = [Point(4000,4000,-1000),
                          Rect(5000,5000,-1000,6000,6000,-1000),
                          Circle(7000,7000,-1000,500)]),
    Units("um"),
    n6  = Node(6e6,0,0),
    Units("in"),
    n7 = Node(7/2.54e-2,0,0),
    Units("mils"),
    n8 = Node(8/2.54e-5,0,0),
    Segment(n1,n2),
    Segment(n2,n3),
    Segment(n3,n4),
    Segment(n4,n5),
    Segment(n5,n6),
    Segment(n6,n7),
    Segment(n7,n8)
    ])
  verified =
  """
  N_1 x=1.000000000e+00 y=0.000000000e+00 z=0.000000000e+00
  .units m
  N_2 x=2.000000000e+00 y=0.000000000e+00 z=0.000000000e+00
  .units km
  N_3 x=3.000000000e-03 y=0.000000000e+00 z=0.000000000e+00
  .units cm
  N_4 x=4.000000000e+02 y=0.000000000e+00 z=0.000000000e+00
  .default
  +  w=7.500000000e+01 h=2.500000000e+01
  .units mm
  N_5 x=5.000000000e+03 y=0.000000000e+00 z=0.000000000e+00
  G_6
  + x1=1.000000000e+03 y1=1.000000000e+03 z1=-1.000000000e+03
  + x2=1.000000000e+03 y2=9.000000000e+03 z2=-1.000000000e+03
  + x3=9.000000000e+03 y3=9.000000000e+03 z3=-1.000000000e+03
  + thick=2.000000000e+02 seg1=20 seg2=20
  + N_7 (2.000000000e+03,2.000000000e+03,-1.000000000e+03)
  + N_8 (3.000000000e+03,3.000000000e+03,-1.000000000e+03)
  + hole point (4.000000000e+03, 4.000000000e+03, -1.000000000e+03)
  + hole rect (5.000000000e+03, 5.000000000e+03, -1.000000000e+03, 6.000000000e+03, 6.000000000e+03, -1.000000000e+03)
  + hole circle (7.000000000e+03, 7.000000000e+03, -1.000000000e+03, 5.000000000e+02)
  .units um
  N_9 x=6.000000000e+06 y=0.000000000e+00 z=0.000000000e+00
  .units in
  N_10 x=2.755905512e+02 y=0.000000000e+00 z=0.000000000e+00
  .units mils
  N_11 x=3.149606299e+05 y=0.000000000e+00 z=0.000000000e+00
  E_12 N_1 N_2
  E_13 N_2 N_3
  E_14 N_3 N_4
  E_15 N_4 N_5
  E_16 N_5 N_9
  E_17 N_9 N_10
  E_18 N_10 N_11
  """
  testelement(g1,verified)
  g2 = transform(g1,txyz(10,0,0))
  verified =
  """
  N_1 x=1.100000000e+01 y=0.000000000e+00 z=0.000000000e+00
  .units m
  N_2 x=1.200000000e+01 y=0.000000000e+00 z=0.000000000e+00
  .units km
  N_3 x=1.300000000e-02 y=0.000000000e+00 z=0.000000000e+00
  .units cm
  N_4 x=1.400000000e+03 y=0.000000000e+00 z=0.000000000e+00
  .default
  +  w=7.500000000e+01 h=2.500000000e+01
  .units mm
  N_5 x=1.500000000e+04 y=0.000000000e+00 z=0.000000000e+00
  G_6
  + x1=1.100000000e+04 y1=1.000000000e+03 z1=-1.000000000e+03
  + x2=1.100000000e+04 y2=9.000000000e+03 z2=-1.000000000e+03
  + x3=1.900000000e+04 y3=9.000000000e+03 z3=-1.000000000e+03
  + thick=2.000000000e+02 seg1=20 seg2=20
  + N_7 (1.200000000e+04,2.000000000e+03,-1.000000000e+03)
  + N_8 (1.300000000e+04,3.000000000e+03,-1.000000000e+03)
  + hole point (1.400000000e+04, 4.000000000e+03, -1.000000000e+03)
  + hole rect (1.500000000e+04, 5.000000000e+03, -1.000000000e+03, 1.600000000e+04, 6.000000000e+03, -1.000000000e+03)
  + hole circle (1.700000000e+04, 7.000000000e+03, -1.000000000e+03, 5.000000000e+02)
  .units um
  N_9 x=1.600000000e+07 y=0.000000000e+00 z=0.000000000e+00
  .units in
  N_10 x=6.692913386e+02 y=0.000000000e+00 z=0.000000000e+00
  .units mils
  N_11 x=7.086614173e+05 y=0.000000000e+00 z=0.000000000e+00
  E_12 N_1 N_2
  +  wx=0.000000000e+00 wy=-1.000000000e+00 wz=0.000000000e+00
  E_13 N_2 N_3
  +  wx=0.000000000e+00 wy=-1.000000000e+00 wz=0.000000000e+00
  E_14 N_3 N_4
  +  wx=0.000000000e+00 wy=-1.000000000e+00 wz=0.000000000e+00
  E_15 N_4 N_5
  +  wx=0.000000000e+00 wy=-1.000000000e+00 wz=0.000000000e+00
  E_16 N_5 N_9
  +  wx=0.000000000e+00 wy=-1.000000000e+00 wz=0.000000000e+00
  E_17 N_9 N_10
  +  wx=0.000000000e+00 wy=-1.000000000e+00 wz=0.000000000e+00
  E_18 N_10 N_11
  +  wx=0.000000000e+00 wy=-1.000000000e+00 wz=0.000000000e+00
  """
  testelement(g2,verified)
  g3 = transform(g2,rx(π/4)*ry(π/4)*rz(π/4))
  verified =
  """
  N_1 x=5.500000000e+00 y=-1.610912703e+00 z=9.389087297e+00
  .units m
  N_2 x=6.000000000e+00 y=-1.757359313e+00 z=1.024264069e+01
  .units km
  N_3 x=6.500000000e-03 y=-1.903805922e-03 z=1.109619408e-02
  .units cm
  N_4 x=7.000000000e+02 y=-2.050252532e+02 z=1.194974747e+03
  .default
  +  w=7.500000000e+01 h=2.500000000e+01
  .units mm
  N_5 x=7.500000000e+03 y=-2.196699141e+03 z=1.280330086e+04
  G_6
  + x1=6.707106781e+03 y1=-1.257359313e+03 z1=8.742640687e+03
  + x2=1.070710678e+04 y2=5.571067812e+03 z2=7.571067812e+03
  + x3=1.470710678e+04 y3=4.399494937e+03 z3=1.439949494e+04
  + thick=2.000000000e+02 seg1=20 seg2=20
  + N_7 (7.707106781e+03,-5.502525317e+02,9.449747468e+03)
  + N_8 (8.707106781e+03,1.568542495e+02,1.015685425e+04)
  + hole point (9.707106781e+03, 8.639610307e+02, 1.086396103e+04)
  + hole rect (1.070710678e+04, 1.571067812e+03, 1.157106781e+04, 1.170710678e+04, 2.278174593e+03, 1.227817459e+04)
  + hole circle (1.270710678e+04, 2.985281374e+03, 1.298528137e+04, 5.000000000e+02)
  .units um
  N_9 x=8.000000000e+06 y=-2.343145751e+06 z=1.365685425e+07
  .units in
  N_10 x=3.346456693e+02 y=-9.801544724e+01 z=5.712758913e+02
  .units mils
  N_11 x=3.543307087e+05 y=-1.037810618e+05 z=6.048803555e+05
  E_12 N_1 N_2
  +  wx=-5.000000000e-01 wy=-8.535533906e-01 wz=1.464466094e-01
  E_13 N_2 N_3
  +  wx=-5.000000000e-01 wy=-8.535533906e-01 wz=1.464466094e-01
  E_14 N_3 N_4
  +  wx=-5.000000000e-01 wy=-8.535533906e-01 wz=1.464466094e-01
  E_15 N_4 N_5
  +  wx=-5.000000000e-01 wy=-8.535533906e-01 wz=1.464466094e-01
  E_16 N_5 N_9
  +  wx=-5.000000000e-01 wy=-8.535533906e-01 wz=1.464466094e-01
  E_17 N_9 N_10
  +  wx=-5.000000000e-01 wy=-8.535533906e-01 wz=1.464466094e-01
  E_18 N_10 N_11
  +  wx=-5.000000000e-01 wy=-8.535533906e-01 wz=1.464466094e-01
  """
  testelement(g3,verified)
end
transformtest1()

function transformtest2()
  g4 = Group([
    Units("mm"),
    n0 = Node( 0, 0, 0),
    n1 = Node( 1, 0, 0),
    Units("cm"),
    n2 = Node(-0.1, 0, 0),
    Units("m"),
    n3 = Node( 0, 0.001, 0),
    Units("km"),
    n4 = Node( 0,-1.0e-6, 0),
    Units("um"),
    n5 = Node( 0, 0, 1000),
    Units("cm"),
    n6 = Node( 0, 0,-0.1),
    Units("m"),
    Default(w=0.5e-3,h=0.1e-3),
    Segment(n0,n1),
    Segment(n0,n2,wx=0,wy=1,wz=1),
    Segment(n0,n3),
    Segment(n0,n4,wx=1,wy=0,wz=1),
    Segment(n0,n5),
    Segment(n0,n6,wx=1,wy=1,wz=0),
    Units("mm"),
    UniformPlane(x1=2, y1=2, z1=-1.5,
                 x2=2, y2=-2, z2=-1.5,
                 x3=-2, y3=-2, z3=-1.5,
                 thick = .2,
                 seg1 = 20,
                 seg2 = 20)
    ])
  verified =
  """
  .units mm
  N_1 x=0.000000000e+00 y=0.000000000e+00 z=0.000000000e+00
  N_2 x=1.000000000e+00 y=0.000000000e+00 z=0.000000000e+00
  .units cm
  N_3 x=-1.000000000e-01 y=0.000000000e+00 z=0.000000000e+00
  .units m
  N_4 x=0.000000000e+00 y=1.000000000e-03 z=0.000000000e+00
  .units km
  N_5 x=0.000000000e+00 y=-1.000000000e-06 z=0.000000000e+00
  .units um
  N_6 x=0.000000000e+00 y=0.000000000e+00 z=1.000000000e+03
  .units cm
  N_7 x=0.000000000e+00 y=0.000000000e+00 z=-1.000000000e-01
  .units m
  .default
  +  w=5.000000000e-04 h=1.000000000e-04
  E_8 N_1 N_2
  E_9 N_1 N_3
  +  wx=0.000000000e+00 wy=1.000000000e+00 wz=1.000000000e+00
  E_10 N_1 N_4
  E_11 N_1 N_5
  +  wx=1.000000000e+00 wy=0.000000000e+00 wz=1.000000000e+00
  E_12 N_1 N_6
  E_13 N_1 N_7
  +  wx=1.000000000e+00 wy=1.000000000e+00 wz=0.000000000e+00
  .units mm
  G_14
  + x1=2.000000000e+00 y1=2.000000000e+00 z1=-1.500000000e+00
  + x2=2.000000000e+00 y2=-2.000000000e+00 z2=-1.500000000e+00
  + x3=-2.000000000e+00 y3=-2.000000000e+00 z3=-1.500000000e+00
  + thick=2.000000000e-01 seg1=20 seg2=20
  """
  testelement(g4,verified)
  g5 = transform(g4,txyz(10,10,10))
  verified =
  """
  .units mm
  N_1 x=1.000000000e+01 y=1.000000000e+01 z=1.000000000e+01
  N_2 x=1.100000000e+01 y=1.000000000e+01 z=1.000000000e+01
  .units cm
  N_3 x=9.000000000e-01 y=1.000000000e+00 z=1.000000000e+00
  .units m
  N_4 x=1.000000000e-02 y=1.100000000e-02 z=1.000000000e-02
  .units km
  N_5 x=1.000000000e-05 y=9.000000000e-06 z=1.000000000e-05
  .units um
  N_6 x=1.000000000e+04 y=1.000000000e+04 z=1.100000000e+04
  .units cm
  N_7 x=1.000000000e+00 y=1.000000000e+00 z=9.000000000e-01
  .units m
  .default
  +  w=5.000000000e-04 h=1.000000000e-04
  E_8 N_1 N_2
  +  wx=0.000000000e+00 wy=-1.000000000e+00 wz=0.000000000e+00
  E_9 N_1 N_3
  +  wx=0.000000000e+00 wy=1.000000000e+00 wz=1.000000000e+00
  E_10 N_1 N_4
  +  wx=1.000000000e+00 wy=0.000000000e+00 wz=0.000000000e+00
  E_11 N_1 N_5
  +  wx=1.000000000e+00 wy=0.000000000e+00 wz=1.000000000e+00
  E_12 N_1 N_6
  +  wx=-1.000000000e+00 wy=0.000000000e+00 wz=0.000000000e+00
  E_13 N_1 N_7
  +  wx=1.000000000e+00 wy=1.000000000e+00 wz=0.000000000e+00
  .units mm
  G_14
  + x1=1.200000000e+01 y1=1.200000000e+01 z1=8.500000000e+00
  + x2=1.200000000e+01 y2=8.000000000e+00 z2=8.500000000e+00
  + x3=8.000000000e+00 y3=8.000000000e+00 z3=8.500000000e+00
  + thick=2.000000000e-01 seg1=20 seg2=20
  """
  testelement(g5,verified)
  g6 = transform(g5,rx(π/4)*ry(π/4)*rz(π/4))
  verified =
  """
  .units mm
  N_1 x=2.928932188e+00 y=1.207106781e+01 z=1.207106781e+01
  N_2 x=3.428932188e+00 y=1.192462120e+01 z=1.292462120e+01
  .units cm
  N_3 x=2.428932188e-01 y=1.221751442e+00 z=1.121751442e+00
  .units m
  N_4 x=3.428932188e-03 y=1.292462120e-02 z=1.192462120e-02
  .units km
  N_5 x=2.428932188e-06 y=1.121751442e-05 z=1.221751442e-05
  .units um
  N_6 x=2.221825407e+03 y=1.257106781e+04 z=1.257106781e+04
  .units cm
  N_7 x=3.636038969e-01 y=1.157106781e+00 z=1.157106781e+00
  .units m
  .default
  +  w=5.000000000e-04 h=1.000000000e-04
  E_8 N_1 N_2
  +  wx=-5.000000000e-01 wy=-8.535533906e-01 wz=1.464466094e-01
  E_9 N_1 N_3
  +  wx=-2.071067812e-01 wy=1.353553391e+00 wz=3.535533906e-01
  E_10 N_1 N_4
  +  wx=5.000000000e-01 wy=-1.464466094e-01 wz=8.535533906e-01
  E_11 N_1 N_5
  +  wx=-2.071067812e-01 wy=3.535533906e-01 wz=1.353553391e+00
  E_12 N_1 N_6
  +  wx=-5.000000000e-01 wy=1.464466094e-01 wz=-8.535533906e-01
  E_13 N_1 N_7
  +  wx=1.000000000e+00 wy=7.071067812e-01 wz=7.071067812e-01
  .units mm
  G_14
  + x1=5.989592360e+00 y1=1.273528137e+01 z1=1.273528137e+01
  + x2=3.989592360e+00 y2=9.321067812e+00 z2=1.332106781e+01
  + x3=1.989592360e+00 y3=9.906854249e+00 z3=9.906854249e+00
  + thick=2.000000000e-01 seg1=20 seg2=20
  """
  testelement(g6,verified)
end
transformtest2()
